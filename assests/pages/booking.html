    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Travel Booking</title>
        <link rel="stylesheet" href="../../css/booking.css">
    </head>
    <body>

        <!-- Header Section -->
        <div class="header">
            <h1>Discover the World with Us</h1>
            <p>"The world is a book and those who do not travel read only one page."</p>
        </div>

        <!-- Display Package Details -->
        <div class="details" id="package-details">
            <h2 id="package-name">Package Name</h2>
            <p><strong>Duration:</strong> <span id="package-duration">Loading...</span></p>
            <p><strong>Price per Person:</strong> <span id="package-price">Loading...</span></p>
            <p id="package-description">Loading...</p>
            <p><strong>Food:</strong> <span id="package-food">Included</span></p>
            <p><strong>Night Stay:</strong> <span id="package-night-stay">Included</span></p>
            <p><strong>Group Size:</strong> <span id="package-group-size">Minimum 5 people</span></p>
        </div>

        <!-- Bottom Section -->
        <div class="bottom-section" id="booking">
            <h2>Booking Summary</h2>
            <div class="price-calculator">
                <div class="price-box">
                    <p><strong>Adults</strong></p>
                    <input type="number" id="adults" value="0" min="0">
                    <p id="adult-price"><strong>0 Rs.</strong></p>
                </div>
                <div class="price-box">
                    <p><strong>Kids</strong></p>
                    <input type="number" id="kids" value="0" min="0">
                    <p id="kid-price"><strong>0 Rs.</strong></p>
                </div>
            </div>
            <h3>Total: <span id="total-price">0 Rs.</span></h3>
            <div class="action-buttons">
                <button class="book-btn" id="bookBtn">Book</button>
                <!-- <button class="cancel-btn" onclick="cancelBooking()">Cancel</button> -->
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>&copy; 2024 Travel Booking. All Rights Reserved.</p>
        </div>

        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
            import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        
            const firebaseConfig = {
                apiKey: "AIzaSyB7ASHWeH7D9uph-jm_DzVYtmgumAtFnq4",
                authDomain: "travworld-858a6.firebaseapp.com",
                projectId: "travworld-858a6",
                storageBucket: "travworld-858a6.firebasestorage.app",
                messagingSenderId: "850634148926",
                appId: "1:850634148926:web:2fd42f92d1e846938e156f",
                measurementId: "G-67LRT5GK62"
            };
        
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
        
            // Display sign-in status
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    alert(`Welcome back, ${user.displayName || user.email}!`);
                } else {
                    alert("Please sign in to book a package.");
                }
            });

       
            let placeName = localStorage.getItem('placeName')
            console.log(placeName);
           
        
            // Fetch package details from JSON file
            // async function fetchPackageDetails() {
            //     try {
            //         const response = await fetch("../json/packages.json");
            //         if (!response.ok) {
            //             throw new Error("Failed to fetch package details");
            //         }
            //         const packageDetails = await response.json();
            //         console.log(packageDetails);
                    
            //         displayPackageDetails(packageDetails);
            //     } catch (error) {
            //         console.error("Error fetching package details:", error);
            //         alert("Failed to load package details. Please try again later.");
            //     }
            // }
        
            // Display package details
            function displayPackageDetails(packageDetails) {
                
                document.getElementById("package-name").textContent = placeName;
                document.getElementById("package-duration").textContent = packageDetails.duration;
                document.getElementById("package-price").textContent = packageDetails.price_per_person;
                document.getElementById("package-description").textContent = packageDetails.description;
        
                // Display itinerary dynamically
                const itineraryList = document.getElementById("package-itinerary");
                itineraryList.innerHTML = ""; // Clear existing content
                for (const [day, details] of Object.entries(packageDetails.itinerary)) {
                    const listItem = document.createElement("li");
                    listItem.innerHTML = `<strong>${day}</strong>: ${details}`;
                    itineraryList.appendChild(listItem);
                }
        
                // setupPriceCalculation(packageDetails);
            }
        
           
        
            // Book Button
            document.getElementById("bookBtn").addEventListener("click", () => {
                const user = auth.currentUser;
                if (!user) {
                    alert("You need to sign in or sign up to book a package.");
                    window.location.href = "../pages/login.html";
                    return;
                }
        
                const totalPrice = parseInt(document.getElementById("total-price").textContent.replace(" Rs.", ""), 10) || 0;
                if (totalPrice < 1000) {
                    alert("Total price must be at least 1000 Rs.");
                    return;
                }
        
                const queryParams = new URLSearchParams({
                    packageName: document.getElementById("package-name").textContent,
                    totalPrice,
                }).toString();
        
                window.location.href = `../pages/payment.html?${queryParams}`;
            });
        
            // Cancel Booking
            // document.getElementById("cancelBtn").addEventListener("click", () => {
            //     document.getElementById("adults").value = 0;
            //     document.getElementById("kids").value = 0;
            //     document.getElementById("total-price").textContent = "0 Rs.";
            //     window.location.href = "homepage.html";
            // });
        
            // Fetch package details when the page loads
            // fetchPackageDetails();
console.log(localStorage.getItem('package'));
document.addEventListener('DOMContentLoaded', () => {
    const dur = localStorage.getItem('package');
    const price = localStorage.getItem('price');
    const description = localStorage.getItem('description');
    
    const packageName = localStorage.getItem('packageName');
    
    // Populate package details
    document.getElementById('package-name').textContent = placeName;
    document.getElementById('package-price').textContent = price;
    document.getElementById('package-description').textContent = description;
    document.getElementById('package-duration').textContent = dur;
    
    // Set initial price calculation
    setupPriceCalculation(price);
});

// Set up price calculation logic
function setupPriceCalculation(pricePerPerson) {
    const adultInput = document.getElementById("adults");
    const kidInput = document.getElementById("kids");
    const adultPriceDisplay = document.getElementById("adult-price");
    const kidPriceDisplay = document.getElementById("kid-price");
    const totalPriceDisplay = document.getElementById("total-price");

    const pricePerPersonInt = parseInt(pricePerPerson.replace(/[^\d]/g, ""), 10);  // Remove Rs. and parse as integer
    const kidDiscountFactor = 0.5; // 50% discount for kids

    // Function to calculate price
    function calculatePrice() {
        const adults = parseInt(adultInput.value) || 0;
        const kids = parseInt(kidInput.value) || 0;

        // Calculate adult and kid prices
        const adultPrice = adults * pricePerPersonInt;
        const kidPrice = kids * (pricePerPersonInt * kidDiscountFactor);
        const totalPrice = adultPrice + kidPrice;

        // Update price displays
        adultPriceDisplay.innerHTML = `<strong>${adults} Adults @ ${pricePerPersonInt} Rs. each = ${adultPrice} Rs.</strong>`;
        kidPriceDisplay.innerHTML = `<strong>${kids} Kids @ ${(pricePerPersonInt * kidDiscountFactor)} Rs. each = ${kidPrice} Rs.</strong>`;
        totalPriceDisplay.textContent = `${totalPrice} Rs.`;
    }

    // Event listeners for both inputs
    adultInput.addEventListener("input", calculatePrice);
    kidInput.addEventListener("input", calculatePrice);

    // Initial calculation (if needed for pre-populated values)
    calculatePrice();
}

// Book Button logic
document.getElementById("bookBtn").addEventListener("click", () => {
    // Check if the user is logged in
    const user = auth.currentUser;  // Firebase auth check
    if (!user) {
        alert("You need to sign in or sign up to book a package.");
        window.location.href = "../pages/login.html";  // Redirect to login if not logged in
        return;
    }

    // Fetch package details
    const packageName = document.getElementById("package-name").textContent.trim();
    const packageDuration = document.getElementById("package-duration").textContent.trim();
    const totalPrice = parseInt(document.getElementById("total-price").textContent.replace(" Rs.", ""), 10) || 0;

    // Validate total price
    if (totalPrice < 1000) {
        alert("Total price must be at least 1000 Rs.");
        return;
    }

    // Construct query parameters
    const queryParams = new URLSearchParams({
        name: packageName,
        duration: packageDuration,
        price: totalPrice,
    }).toString();

    // Redirect to payment page with details
    window.location.href = `../pages/payment.html?${queryParams}`;
});

           
        </script>
                
        
    </body>
    </html>
