<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tour Details</title>
  <link rel="stylesheet" href="../../css/info.css">
  <style>
    .error-message {
      color: red;
      font-size: 0.9em;
      display: none; /* Hide error messages by default */
    }
  </style>
</head>
<body>
  <div class="details-container">
    <div class="tour-info">
      <h1 id="tour-title">Loading...</h1>
      <p id="tour-location"></p>
      <div class="details">
        <p><strong>Tour Type:</strong> Daily Tour</p>
        <p><strong>Group Size:</strong> Unlimited</p>
        <p><strong>Languages:</strong> English</p>
      </div>
      <img id="tour-image" alt="Tour Image">
    </div>
    <div class="enquiry-section">
      <h2>Stay Connected</h2>
      <p>ðŸ“ž +91 9344946575</p>
      <p>ðŸ“§ travelworld@gmail.com</p>
      <form id="enquiry-form">
        <label for="name">Name *</label>
        <input type="text" id="name" placeholder="Enter your name" required>
        <span class="error-message" id="name-error"></span>

        <label for="city">City of Residence *</label>
        <input type="text" id="city" placeholder="Enter your city" required>
        <span class="error-message" id="city-error"></span>

        <label for="email">Email *</label>
        <input type="email" id="email" placeholder="Enter your email" required>
        <span class="error-message" id="email-error"></span>

        <label for="phone">Phone Number *</label>
        <input type="tel" id="phone" placeholder="Enter your phone number" required>
        <span class="error-message" id="phone-error"></span>

        <label for="destination">Travel Destination *</label>
        <input type="text" id="destination" placeholder="Enter travel destination" required>
        <span class="error-message" id="destination-error"></span>

        <label for="date">Date of Travel *</label>
        <input type="date" id="date" required>
        <span class="error-message" id="date-error"></span>

        <label for="people">packageDuration *</label>
        <input type="number" id="packageDuration" placeholder="Enter packageDuration" required>
        <span class="error-message" id="people-error"></span>

        <button type="submit">Submit</button>
      </form>
    </div>
  </div>
  <script>
    // Fetching tour details based on query parameters
    const queryParams = new URLSearchParams(window.location.search);
    const category = queryParams.get('category');
    const index = queryParams.get('index');
  
  console.log(category);
  
    
    fetch('../json/navjson.json')
        .then(response => response.json())
        .then(data => {
            const tours = data[category];
            if (!tours) {
                document.body.innerHTML = '<h1>Invalid category selected. Please try again.</h1>';
                return;
            }

            const tour = tours[index];
            if (tour) {
          let packageName= document.getElementById('tour-title').textContent = tour.name;
             localStorage.setItem("packageName",packageName)
              
                
           document.getElementById('tour-location').textContent = tour.location?.state || 'Location not available';
                document.getElementById('tour-image').src = tour.image_url || 'placeholder.jpg';
                document.getElementById('tour-image').alt = tour.name || 'Tour image';
            } else {
                document.body.innerHTML = '<h1>Tour not found</h1>';
            }
        })
        .catch(error => {
            console.error('Error fetching tour details:', error);
            document.body.innerHTML = '<h1>Error loading tour details. Please try again later.</h1>';
        });

      
        // Form validation logic
const form = document.getElementById('enquiry-form');
form.addEventListener('submit', function (event) {
    event.preventDefault(); // Prevent default form submission behavior

    let isValid = true;

    // const validateField = (id, message, condition) => {
    //     const field = document.getElementById(id);
    //     const error = document.getElementById(`${id}-error`);
    //     if (condition(field.value)) {
    //         error.textContent = message;
    //         error.style.display = 'block'; // Show the error message
    //         isValid = false;
    //     } else {
    //         error.style.display = 'none'; // Hide the error message
    //     }
    // };

    // // Name Validation: At least 3 characters
    // validateField('name', 'Give a valid name.', value => value.trim().length < 3);

    // // City Validation: Minimum 3 characters, maximum 50 characters
    // validateField('city', 'City is invalid.', value => value.trim().length < 3 || value.trim().length > 50);

    // // Email Validation: Should not exceed 50 characters
    // validateField('email', 'Email is too long.', value => value.trim().length > 40);

    // // Phone Validation: Must be 10 digits without spaces or hyphens
    // validateField(
    //     'phone',
    //     'Invalid number.',
    //     value => !/^\d{10}$/.test(value.trim())
    // );

    // // Destination Validation: Required
    // validateField('destination', 'Travel destination is required.', value => value.trim() === '');

    // // Date Validation: Required
    // validateField('date', 'Date of travel is required.', value => value.trim() === '');

    // // Package Duration Validation: Required
    // validateField('packageDuration', 'Travel packageDuration is required.', value => value.trim() === '');

    if (!isValid) return;

    // Get user-provided details
    const name = document.getElementById('name').value.trim();
    const city = document.getElementById('city').value.trim();
    const email = document.getElementById('email').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const travelDate = document.getElementById('date').value.trim();
    const packageDuration = document.getElementById('packageDuration').value.trim();

    // Get tour details
    const tourTitle = document.getElementById('tour-title').textContent.trim();
    console.log(tourTitle);

    const tourLocation = document.getElementById('tour-location').textContent.trim();

    let packageName = localStorage.getItem("packageName");
    console.log(packageName);
    let totalPrice = 2000;
    const queryParams = new URLSearchParams({
        name: packageName,
        duration: packageDuration,
        price: totalPrice,
        date: travelDate,
    }).toString();
    window.location.href = `../pages/payment.html?${queryParams}`;
});
  </script>
</body>
</html>
